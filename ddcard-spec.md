# Карточка электронного документа

Данная спецификация описывает **карточку электронного документа** — ориентированный на людей композитный формат хранения подлинников электронных документов и ЭЦП под ними, основанный на стандартизованном и широко используемом формате файлов PDF, а так же распространённом в Республике Казахстан формате упаковки цифровых подписей CMS (CAdES).

Отличительные особенности формата **карточки электронного документа**:
- один файл включает в себя все необходимые данные для долгосрочного хранения электронных документов;
- содержит в себе достаточный объём информации для проверки цифровых подписей под электронным документом в любой момент времени без необходимости взаимодействовать с какими-либо информационными системами, сервисами, в том числе с сервисами УЦ;
- визуально отображаемая часть может включать в себя визуализацию подписанного электронного документа и визуализацию цифровых подписей.

Спецификация разрабатывалась с учётом следующих принципов, которые также должны служить основным ориентиром при разработке следующих версий спецификации:
- **удобство для людей** — нельзя ущемлять права участников информационного взаимодействия, отправителей и получателей электронных документов, не являющихся специалистами в области информационных технологий, поэтому технические средства, в том числе и форматы хранения данных, следует разрабатывать так, чтобы они были информативны, наглядны и понятны;
- **прозрачность** — люди имеют право знать что именно было подписано ЭЦП, то есть что именно является электронным документом в терминологии Закона РК «Об электронном документе и электронной цифровой подписи»;
- **целостность** — необходимо сохранять всю информацию, необходимую для полноценной проверки ЭЦП в любой момент времени после подписания электронного документа;
- **открытость и доступность** — при разработке спецификации следует отдавать предпочтение тем технологиям, стандартам, спецификациям и программному обеспечению, которые общедоступны, общеприняты и не ставят участников информационного взаимодействия в зависимость от закрытых проприетарных разработок.

Спецификация **карточки электронного документа** разработана с прицелом на такие сценарии обработки и хранения электронных документов, в которых участвуют люди и которые не привязаны к конкретным информационным системам, к примеру:
- экспорт электронных документов из информационных систем;
- обмен электронными документами людьми без применения информационных систем, к примеру, по электронной почте, с использованием мессенджеров или через корпоративное облачное хранилище;
- импорт электронных документов в информационные системы;
- архивное хранение электронных документов вне информационных систем.

Информационные системы, реализующие данную спецификацию, образуют единое информационное пространство с общим форматом передачи данных, участвовать в котором могут не только машины, но и обычные люди.

## Формат хранения данных
**Карточка электронного документа** — это основной файл (PDF, версия спецификации не ниже 1.4), логически состоящий из двух компонент:
- визуально отображаемая часть;
- вложенные файлы.

**Визуально отображаемая часть** — это текстовая и графическая информация в PDF-файле. Она предназначена для того, чтобы любой человек, получивший **карточку электронного документа**, мог быстро ознакомиться с содержимым документа используя стандартные средства, имеющиеся в большинстве потребительских информационно-вычислительных устройств, таких как компьютеры, ноутбуки, смартфоны, планшеты и электронные книги. Визуально отображаемая часть **предназначена только для поверхностного ознакомления** и **не обладает юридической значимостью**, так как она не защищена техническими средствами от изменения или искажения злоумышленниками.

**Вложенные файлы** — это подлинник электронного документа и электронные цифровые подписи под ним. Можно утверждать что подлинник электронного документа обладает юридической значимостью в соответствии с законодательством РК после того, как была удостоверена его целостность путём выполнения проверок ЭЦП под ним. Для выполнения проверок ЭЦП требуются специальные технические средства. В настоящее время разработаны библиотека с открытым исходным кодом и прототип ПО на основе этой библиотеки, позволяющий формировать **карточку электронного документа** и осуществлять проверку. Предполагается, что по мере принятия спецификации всё большим количеством организаций и информационных систем, будет появляться всё больше различных инструментов, позволяющих выполнять проверки подписей.

## Требования к ЭЦП
Данная спецификация определяет набор требований к электронным цифровым подписям для того, чтобы упростить процедуру импорта электронных документов в информационные системы.

Спецификация допускает исключительно те цифровые подписи, которые могут считаться равнозначными собственноручным подписям в соответствии с законодательством Республики Казахстан. В частности, это означает что подписи должны быть сформированы с применением сертификатов (регистрационных свидетельств), выпущенных аккредитованными удостоверяющими центрами Республики Казахстан.

Дополнительные требования к ЭЦП:
- цифровые подписи должны быть упакованы в формат CMS (RFC 5652) — один поддерживаемый формат упростит анализ криптографических структур и снизит вероятность ошибок, а, следовательно, и уязвимостей;
- в каждом CMS, в поле `certificates` структуры `SignedData` должен быть приведён сертификат (регистрационное свидетельство) подписавшей стороны, то есть тот, открытый ключ в котором соответствует закрытому ключу, использованному для подписания;
- подписанные данные не должны быть включены в CMS (`external signatures` в терминах RFC 5652), то есть поле `eContent` должно отсутствовать в `EncapsulatedContentInfo` — подписанные данные включены в карточку электронного документа в виде отдельного файла;
- метка времени TSP (RFC 3161) должна быть встроена в CMS в виде неподписанного атрибута `1.2.840.113549.1.9.16.2.14` (RFC 3161, APPENDIX A — Signature Time-stamp attribute using CMS), моментом формирования подписи следует считать значение поля `genTime` (значение этого поля устанавливает сервис УЦ, выполняющий роль центрального доверенного источника точного времени, значение включено в блок данных, подписанных специализированным сертификатом этого сервиса и таким образом защищено от изменения) структуры `TSTInfo` метки времени TSP;
- подтверждение валидного статуса сертификата, использованного при подписании, должно быть предоставлено одним из следующих образов:
  - в виде ответа OCSP (RFC 6960), с успешным статусом проверки сертификата, который должен быть встроен в CMS в виде неподписанного атрибута `1.2.840.113549.1.9.16.2.24` (RFC 5126, 6.3.4.  revocation-values Attribute Definition), в этом случае разница между моментом формирования подписи и значением поля `thisUpdate` OCSP ответа (момент, на который был известен указанный статус сертификата, значение включено в блок данных, подписанных специализированным сертификатом этого сервиса и таким образом защищено от изменения) не должна превышать 5 (пять) минут;
  - в виде списка отозванных сертификатов CRL (RFC 5280), подтверждающего статус сертификата, который должен быть встроен в CMS в виде неподписанного атрибута `1.2.840.113549.1.9.16.2.24` (RFC 5126, 6.3.4.  revocation-values Attribute Definition), в этом случае момент формирования подписи должен попадать в промежуток между значениями `thisUpdate` (момент формирования списка отозванных сертификатов сервисом УЦ, значение включено в блок данных, подписанных сертификатом этого сервиса и таким образом защищено от изменения, зачастую в качестве сертификата этого сервиса используется сертификат УЦ) и `nextUpdate` (момент когда следующий обновленный список отозванных сертификатов должен быть сформирован сервисом УЦ, значение включено в блок данных, подписанных специализированным сертификатом этого сервиса и таким образом защищено от изменения, зачастую в качестве сертификата этого сервиса используется сертификат УЦ). В случае, если УЦ, выпустивший сертификат, поддерживает разностные CRL (RFC 5280, 5 CRL and CRL Extensions Profile), то, помимо базового CRL, обязательно должен быть предоставлен и разностный CRL.

Для снижения объёмов передаваемых и хранимых данных, настоятельно рекомендуется предоставлять подтверждение валидности статусов сертификатов в виде OCSP ответов.

## Визуально отображаемая часть
Визуально отображаемая часть служит для быстрого ознакомления с содержимым электронного документа и ЭЦП под ним. Она состоит из блоков, размещённых в следующей последовательности:
- информационный блок (обязательно);
- визуализация электронного документа (опционально);
- визуализация всех имеющихся ЭЦП под электронным документом (опционально).

Общие требования к визуально отображаемой части:
- формат страницы A4, рекомендуется портретная ориентация;
- отступы слева 30 мм, сверху 20 мм, справа 10 мм, снизу 20 мм;
- рекомендуется использовать легко читаемые свободно распространяемые шрифты;
- рекомендуется придерживаться диапазона размеров шрифтов 8-14 для основных данных;
- нумерация страниц начинается с первой страницы, порядковый номер страницы и общее количество страниц отображается в нижнем колонтитуле справа, начиная со второй страницы;
- начиная со второй страницы, нижний колонтитул слева должен содержать слова `Карточка электронного документа`.

### Информационный блок
Информационный блок следует размещать в начале **карточки электронного документа**, он должен содержать следующие данные:
- строку `Карточка электронного документа`;
- наименование электронного документа;
- (опционально) краткое описание электронного документа;
- дату формирования данной карточки электронного документа;
- время формирования данной карточки электронного документа с обязательным указанием часового пояса. Рекомендуется приводить время к часовому поясу UTC+6 (часовой пояс города Нур-Султан);
- наименование информационной системы или сервиса, в котором была сформирована данная карточка электронного документа;
- содержание визуально отображаемой части карточки с указанием страниц;
- перечень вложенных файлов с указанием имен файлов и примечаний;
- упоминание о том, что в процессе формирования данной карточки информационная система выполнила проверки подписей и проверила целостность подписанных данных;
- пояснение о том, что такое карточка электронного документа;
- пояснение о том, что такое подлинник электронного документа;
- пояснение о том, как выполнить проверку подписи с использованием той информационной системы или сервиса, в котором была сформирована карточка;
- предостережение о том, что визуально отображаемая часть не защищена от модификаций и не имеет юридической значимости.

Информационный блок может занимать одну или более страниц в зависимости от детализации содержания и количества вложенных файлов.

С примерами оформления и текстов можно ознакомиться в шаблоне карточки электронного документа — файле *template.pdf*.

### Визуализация электронного документа
**Карточка электронного документа** может включать в себя визуализацию электронного документа. Решение о том, включать визуализацию электронного документа в карточку или нет, рекомендуется предоставлять пользователю, запрашивающему формирование карточки. Визуализацию следует размещать на отдельных страницах.

Визуализация электронного документа должна отображать фактическое содержимое электронного документа, так как она предназначена не для того, чтобы пояснить, разъяснить или дополнить содержимое электронного документа, а для того, чтобы предоставить человеку возможность ознакомиться с фактическим содержимым электронного документа. К примеру:
- визуализация офисных документов (DOC, DOCX, ODT, XLS, XLSX, ODS и т.п.) не должна существенно отличаться от того, как эти документы отображают такие приложения, как MS Office, LibreOffice и OpenOffice и подобные;
- визуализация PDF файлов не должна существенно отличаться от того, как эти файлы отображают такие программы, как Adobe Acrobat Reader, Chrome, Firefox и подобные;
- визуализация простых тестовых документов (TXT, XML, JSON, YAML и т.п.) должна представлять из себя текст этих документов, разрешено добавлять переносы каретки для того, чтобы длинные строки не вылезали за края страницы;
- визуализацию HTML документа со встроенными таблицами стилей CSS рекомендуется выполнять в таком виде, как этот документ отобразили бы широко распространенные браузеры Chrome, Firefox или Safari.

Запрещается формировать визуализацию таким образом, чтобы она существенно отличалась от содержимого электронного документа, отображаемое стандартными (распространенными) программами для просмотра и редактирования этого типа данных. К примеру:
- запрещено выполнять визуализацию XML файла путем наполнения шаблона оформления данными из XML файла в том случае, если шаблон содержит уточняющую информацию (пояснения, человекочитаемые наименования полей, какую-либо интерпретацию значений из XML файла), так как подобная визуализация не будет соответствовать содержимому подлинника электронного документа, а будет являться его субъективной интерпретацией и в значительной степени зависеть от того, какой шаблон использовался.

Верхний колонтитул каждой страницы визуализации электронного должен содержать слова `Визуализация электронного документа`.

Поверх визуализации электронного документа на каждой странице визуализации необходимо разместить хорошо читаемый водяной знак `Визуализация электронного документа`.

### Визуализация ЭЦП под электронным документом
**Карточка электронного документа** может включать в себя визуализации подписей. Следует либо включать визуализации всех вложенных подписей, либо не включать их вовсе. Не допустимо приводить визуализации тех подписей, которые не вложены в карточку. Решение о том, включать визуализации подписей в карточку или нет, рекомендуется предоставлять пользователю, запрашивающему формирование карточки.

Визуализацию каждой подписи следует размещать на отдельной странице.

Визуализация каждой подписи должна включать в себя следующую информацию в текстовом человекочитаемом виде:
- ФИО подписавшего;
- ИИН подписавшего, либо другой государственный идентификатор;
- (для сертификатов юридических лиц) наименование организации, сотрудником которой является подписавший;
- (для сертификатов юридических лиц) БИН организации, либо другой государственный идентификатор;
- содержимое поля subject в текстовом виде в соответствии с RFC 4514 (опционально);
- серийный номер сертификата (регистрационного свидетельства);
- дата и время начала и окончания срока действия сертификата (регистрационного свидетельства), рекомендуется использовать тот же самый часовой пояс, что был указан на первой странице информационного блока карточки электронного документа;
- шаблон, на основании которого был выпущен сертификат (регистрационное свидетельство) в человекочитаемом виде и в виде OID;
- информация о разрешённых использованиях ключа (keyUsage) в человекочитаемом виде;
- информация о разрешённых расширенных использованиях ключа (extendedKeyUsage) в человекочитаемом виде и в виде OID;
- информация об организации, выпустившей сертификат (регистрационное свидетельство) — содержимое поля `issuer` в текстовом виде в соответствии с RFC 4514;
- дату и время формирования подписи с указанием часового пояса (моментом формирования подписи следует считать значение поля `genTime` (значение этого поля устанавливает сервис УЦ, выполняющий роль центрального доверенного источника точного времени, значение включено в блок данных, подписанных специализированным сертификатом этого сервиса и таким образом защищено от изменения) структуры `TSTInfo` метки времени TSP), рекомендуется использовать тот же самый часовой пояс, что был указан на первой странице информационного блока карточки электронного документа;
- информация о наличии метки времени TSP:
  - дата и время метки времени (значение поля `genTime` структуры `TSTInfo` метки времени TSP) с указанием часового пояса, рекомендуется использовать тот же самый часовой пояс, что был указан на первой странице информационного блока карточки электронного документа;
  - серийный номер сертификата (регистрационного свидетельства), использованного для подписания метки времени;
  - содержимое поля `subject` сертификата (регистрационного свидетельства), использованного для подписания метки времени, в текстовом виде в соответствии с RFC 4514;
  - содержимое поля `issuer` сертификата (регистрационного свидетельства), использованного для подписания метки времени, в текстовом виде в соответствии с RFC 4514;
- (если подтверждением статуса сертификата является OCSP ответ) информация об OCSP ответе:
  - дата и время OCSP ответа (значение поля `thisUpdate`);
  - статус сертификата `CertStatus` из OCSP ответа;
  - серийный номер сертификата (регистрационного свидетельства), использованного для подписания OCSP ответа;
  - содержимое поля `subject` сертификата (регистрационного свидетельства), использованного для подписания OCSP ответа, в текстовом виде в соответствии с RFC 4514;
  - содержимое поля `issuer` сертификата (регистрационного свидетельства), использованного для подписания OCSP ответа, в текстовом виде в соответствии с RFC 4514;
- (если подтверждением статуса сертификата является CRL) информация из базового CRL:
  - дата и время CRL (значение поля `thisUpdate`);
  - дата и время окончания срока действия CRL (значение поля `nextUpdate`);
  - информация об отсутствии, либо наличии серийного номера сертификата в CRL;
  - серийный номер сертификата (регистрационного свидетельства), использованного для подписания CRL;
  - содержимое поля `subject` сертификата (регистрационного свидетельства), использованного для подписания CRL, в текстовом виде в соответствии с RFC 4514;
  - содержимое поля `issuer` сертификата (регистрационного свидетельства), использованного для подписания CRL, в текстовом виде в соответствии с RFC 4514;
- (если подтверждением статуса сертификата является CRL и УЦ поддерживает разностные CRL) информация из разностного CRL:
  - дата и время CRL (значение поля `thisUpdate`);
  - дата и время окончания срока действия CRL (значение поля `nextUpdate`);
  - информация об отсутствии серийного номера сертификата в CRL, либо уведомление о том, что он присутствует там с кодом причины `removeFromCRL`;
  - серийный номер сертификата (регистрационного свидетельства), использованного для подписания CRL;
  - содержимое поля `subject` сертификата (регистрационного свидетельства), использованного для подписания CRL, в текстовом виде в соответствии с RFC 4514;
  - содержимое поля `issuer` сертификата (регистрационного свидетельства), использованного для подписания CRL, в текстовом виде в соответствии с RFC 4514.

Визуализация подписи может включать в себя подпись, закодированную в виде набора QR кодов. Решение о том, включать QR коды в визуализацию подписи или нет, рекомендуется предоставлять пользователю, запрашивающему формирование карточки.

Каждый QR код из набора должен кодировать JSON структуру содержащую, как минимум, следующие данные (переносы каретки и отступы не обязательны, приведены в описании для наглядности):
```
{
  "signId": 9,
  "total": 7,
  "index": 1,
  "data": ""
}
```

- `signId` — идентификатор подписи, необходим для того, чтобы можно было однозначно определить к какой подписи относится данный QR код в том случае, если документ включает в себя QR коды нескольких подписей;
- `total` — общее количество QR кодов, кодирующих данную подпись, позволит удостовериться в том, что все QR коды из набора считаны успешно;
- `index` — номер данного QR в наборе QR кодов, кодирующих данную подпись, необходим для восстановления корректного порядка частей;
- `data` — часть строки `Base64` с данными.

Допустимо дополнять структуру дополнительными данными.

Генерацию набора QR кодов следует осуществлять следующим образом:
- каждая подпись должна иметь уникальный идентификатор (уникальный, как минимум, в контексте формируемой карточки электронного документа);
- выбрать версию QR кода и уровень коррекции ошибок (https://www.qrcode.com/en/about/version.html), рекомендуется использовать версию `25` и уровень коррекции ошибок `M`;
- определить максимальную длину строки, которую можно закодировать в QR код с выбранными параметрами;
- сформировать оценочную JSON структуру, заполнив поле `signId` корректными данными, поля `total` и `index` установив в `0`, поле `data` в `""`;
- определить длину строки оценочной JSON структуры;
- вычислить максимальную длину подстроки с данными по формуле `"максимальная длина строки" - "длина строки оценочной JSON структуры" - 10`, где 10 символов зарезервированы под значения полей `total` и `index`;
- байты подписи упаковать как файл в ZIP архив методом DEFLATE, для формирования имени архивируемого файла использовать формат `signId.cms`, где `signId` — это уникальный идентификатор подписи;
- закодировать полученный ZIP архив в строку `Base64`;
- разбить строку `Base64` на подстроки в соответствии с определенной ранее максимальной длинной подстроки с данными;
- для каждой подстроки сформировать JSON структуру;
- текстовое представление каждой JSON структуры закодировать в изображение QR кода, рекомендуется использовать формат PNG, под каждую клетку QR кода выделять не менее 2-х пикселей.

## Вложенные файлы
Вложенные файлы следует встраивать в основной PDF файл как встроенные потоки файлов (`Embedded File Streams` в терминологии спецификации PDF), которые были добавлены в версии 1.4 в 2001 году. Для встраивания следует использовать элементы `EmbeddedFiles` словаря `Name Dictionary`, ассоциирующие вложенный файл со всем документом. Данный подход выбран исходя из соображений его полной поддержки популярными приложениями для просмотра PDF-файлов (например, Adobe Acrobat Reader, браузер Firefox).

Так как встроенные потоки файлов в основном PDF-файле записаны один после другого, то можно говорить о последовательности вложенных файлов. Первым вложенным файлом всегда должен быть подлинник электронного документа. За ним должны следовать цифровые подписи в последовательности их формирования. За момент формирования подписи следует принимать значение поля `genTime` (значение этого поля устанавливает сервис УЦ, выполняющий роль центрального доверенного источника точного времени, значение включено в блок данных, подписанных специализированным сертификатом этого сервиса и таким образом защищено от изменения) структуры `TSTInfo` метки времени TSP.

Все вложенные файлы должны быть адекватно именованы, то есть должны иметь читаемое имя файла. Настоятельно рекомендуется указывать расширение для упрощения идентификации типов файлов программным обеспечением и пользователями. Это необходимо для того, чтобы пользователи всегда имели возможность беспрепятственно сохранять вложенные файлы на файловые системы своих устройств. Допустимо не указывать расширения файлов только в тех случаях, когда это нарушает сложившиеся практики или противоречит стандартам, но нужно иметь в виду, что отсутствие расширения у файла усложняет идентификацию типа файла и противоречит принципу **удобство для людей**.

Имена файлов должны быть в кодировке UTF-8. Не допускается использование других кодировок (таких как Windows-1251), так как это может вызывать проблемы при сохранении вложенных файлов на файловую систему в некоторых операционных системах.

Вложенные файлы не должны быть исполняемыми файлами (https://helpx.adobe.com/acrobat/using/attachments-security-risks-reader-acrobat.html#attachments_as_security_risks_in_reader_and_acrobat).

Настоятельно рекомендуется выполнять проверку вкладываемых файлов на наличие вирусов и других угроз в процессе формирования карточки.

В части формата вложенного файла рекомендуется следовать требованиям пункта 45 [Правил документирования, управления документацией и использования систем электронного документооборота в государственных и негосударственных организациях](https://adilet.zan.kz/rus/docs/P1800000703):
> 45. Электронные документы на хранение передаются согласно государственному стандарту СТ РК "Управление документацией. Формат файлов электронных документов для долгосрочного хранения. Часть 1. Использование PDF 1.4 (PDF/A-1)".

## Проверка подписей и целостности данных в карточке электронного документа
При получении **карточки электронного документа** информационная система должна удостовериться в целостности подлинника электронного документа путём проверки всех вложенных подписей под ним. Эту процедуру информационной системе следует выполнять при каждом случае получения карточки из внешнего источника, в том числе:
- при импорте карточки полученной от пользователя;
- при получении карточки из сторонней информационной системы;
- при запросе проверки карточки пользователем или информационной системой.

Разработчикам информационных систем важно помнить о том, что достоверной можно считать информацию исключительно во вложенных файлах и только после проверки цифровых подписей.

Подготовительные шаги перед выполнением проверки подписей:
- удостовериться в том, что в качестве карточки электронного документа был передан PDF-файл;
- извлечь первый вложенный файл, считать его электронным документом;
- в том случае, если в качестве электронного документа был передан исполняемый файл, рекомендуется прекратить проверку с ошибкой;
- рекомендуется проверить электронный документ на наличие вирусов и вредоносного программного обеспечения;
- извлечь все остальные вложенные файлы, считать их файлами цифровых подписей.

Для подтверждения юридической значимости электронного документа, проверку подписей под ним следует выполнять в соответствии с законодательством РК, в частности, с Правилами проверки подлинности электронной цифровой подписи, утверждёнными [Приказом Министра по инвестициям и развитию Республики Казахстан «Об утверждении Правил проверки подлинности электронной цифровой подписи»](https://adilet.zan.kz/rus/docs/V1500012864).

Дополнительно, следует выполнять следующие проверки каждой ЭЦП, невыполнение любой из которых должно помечать подпись как не прошедшую проверку:
- удостовериться в том, что подпись упакована в CMS;
- удостовериться в том, что в подписи присутствуют метка времени в соответствии с разделом «Требования к ЭЦП»;
- в метке времени проверить подпись сервиса, сформировавшего ее, построить и проверить цепочку сертификатов от сертификата сервиса до одного из доверенных сертификатов УЦ;
- за момент формирования подписи принять значение поля `genTime` (значение этого поля устанавливает сервис УЦ, выполняющий роль центрального доверенного источника точного времени, значение включено в блок данных, подписанных специализированным сертификатом этого сервиса и таким образом защищено от изменения) структуры `TSTInfo` метки времени;
- удостовериться в том, что для подписи присутствует доказательство валидного статуса сертификата (регистрационного свидетельства) в соответствии с разделом «Требования к ЭЦП»;
- в том случае, если в качестве доказательства приведен CRL, проверить, выпускает ли УЦ, выпустивший сертификат, использованный для подписания электронного документа, разностные CRL, в том случае, если выпускает, удостовериться в наличии разностного CRL;
- проверить подписи соответствующих сервисов под ответами OCSP и CRL, построить и проверить цепочки сертификатов от сертификатов сервисов до одного из доверенных сертификатов УЦ;
- удостовериться в том, что доказательство валидного статуса сертификата приведено на момент формирования подписи, то есть:
  - в том случае, если в качестве доказательства приведен ответ OCSP, разница между моментом формирования подписи и значением поля `thisUpdate` OCSP ответа (момент, на который был известен указанный статус сертификата, значение включено в блок данных, подписанных специализированным сертификатом этого сервиса и таким образом защищено от изменения) не должна превышать 5 (пять) минут;
  - в том случае, если в качестве доказательства приведен CRL, момент формирования подписи должен попадать в промежуток между значениями `thisUpdate` (момент формирования списка отозванных сертификатов сервисом УЦ, значение включено в блок данных, подписанных сертификатом этого сервиса и таким образом защищено от изменения, зачастую в качестве сертификата этого сервиса используется сертификат УЦ) и `nextUpdate` (момент когда следующий обновленный список отозванных сертификатов должен быть сформирован сервисом УЦ, значение включено в блок данных, подписанных специализированным сертификатом этого сервиса и таким образом защищено от изменения, зачастую в качестве сертификата этого сервиса используется сертификат УЦ).

В том случае, если хотя бы одна из вложенных подписей не прошла проверку, следует считать все данные в карточке недостоверными.
